generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model admin {
  admin_id   Int        @id @default(autoincrement())
  name       String     @unique
  email      String     @unique
  role       admin_role
  created_at DateTime   @default(now())
}

model bookinginquiry {
  inquiry_id   Int                    @id @default(autoincrement())
  tenant_id    Int?
  property_id  Int?
  inquiry_date DateTime               @default(now())
  status       bookinginquiry_status? @default(Pending)
  message      String?
  tenant       tenant?                @relation(fields: [tenant_id], references: [tenant_id])
  property     property?              @relation(fields: [property_id], references: [property_id])

  @@index([property_id])
  @@index([tenant_id])
}

model document {
  document_id     Int              @id @default(autoincrement())
  agreement_id    Int?
  document_url    String
  uploaded_at     DateTime         @default(now())
  rentalagreement rentalagreement? @relation(fields: [agreement_id], references: [agreement_id])

  @@index([agreement_id])
}

model favoriteproperties {
  favorite_id Int       @id @default(autoincrement())
  tenant_id   Int?
  property_id Int?
  created_at  DateTime  @default(now())
  tenant      tenant?   @relation(fields: [tenant_id], references: [tenant_id])
  property    property? @relation(fields: [property_id], references: [property_id])

  @@index([property_id])
  @@index([tenant_id])
}

model landlord {
  landlord_id         Int               @id @default(autoincrement())
  name                String
  email               String            @unique
  phone_number        String
  business_name       String?
  profile_picture_url String?
  created_at          DateTime          @default(now())
  property            property[]
  rentalagreement     rentalagreement[]
}

model location {
  location_id Int        @id @default(autoincrement())
  address     String
  city        String
  region      String
  country     String
  latitude    Decimal?   // MySQL handles DECIMAL natively
  longitude   Decimal?
  postal_code String?
  property    property[]
}

model maintenancerequest {
  request_id  Int                        @id @default(autoincrement())
  tenant_id   Int?
  property_id Int?
  description String
  status      maintenancerequest_status? @default(Pending)
  created_at  DateTime                   @default(now())
  resolved_at DateTime?
  tenant      tenant?                    @relation(fields: [tenant_id], references: [tenant_id])
  property    property?                  @relation(fields: [property_id], references: [property_id])

  @@index([property_id])
  @@index([tenant_id])
}

model notification {
  notification_id   Int                            @id @default(autoincrement())
  user_id           Int?
  notification_type notification_notification_type
  message           String
  sent_at           DateTime                       @default(now())
  read_status       notification_read_status?      @default(Unread)
  tenant            tenant?                        @relation(fields: [user_id], references: [tenant_id])

  @@index([user_id])
}

model payment {
  payment_id      Int                     @id @default(autoincrement())
  agreement_id    Int?
  amount          Decimal                 // MySQL handles DECIMAL natively
  payment_date    DateTime
  payment_method  payment_payment_method
  payment_status  payment_payment_status? @default(Pending)
  rentalagreement rentalagreement?        @relation(fields: [agreement_id], references: [agreement_id])

  @@index([agreement_id])
}

model property {
  property_id         Int                           @id @default(autoincrement())
  landlord_id         Int?
  location_id         Int?
  property_name       String
  property_type       property_property_type
  number_of_bedrooms  Int
  number_of_bathrooms Int
  square_footage      Decimal?                      // MySQL handles DECIMAL natively
  description         String?
  price_per_month     Decimal                       // MySQL handles DECIMAL natively
  availability_status property_availability_status? @default(Available)
  amenities           String?
  created_at          DateTime                      @default(now())
  bookinginquiry      bookinginquiry[]
  favoriteproperties  favoriteproperties[]
  maintenancerequest  maintenancerequest[]
  landlord            landlord?                     @relation(fields: [landlord_id], references: [landlord_id])
  location            location?                     @relation(fields: [location_id], references: [location_id])
  propertyimage       propertyimage[]
  rentalagreement     rentalagreement[]
  review              review[]

  @@index([landlord_id])
  @@index([location_id])
}

model propertyimage {
  image_id    Int       @id @default(autoincrement())
  property_id Int?
  image_url   String
  uploaded_at DateTime  @default(now())
  property    property? @relation(fields: [property_id], references: [property_id])

  @@index([property_id])
}

model rentalagreement {
  agreement_id     Int                     @id @default(autoincrement())
  tenant_id        Int?
  landlord_id      Int?
  property_id      Int?
  start_date       DateTime
  end_date         DateTime
  monthly_rent     Decimal                 // MySQL handles DECIMAL natively
  security_deposit Decimal?                // MySQL handles DECIMAL natively
  status           rentalagreement_status? @default(Active)
  created_at       DateTime                @default(now())
  document         document[]
  payment          payment[]
  tenant           tenant?                 @relation(fields: [tenant_id], references: [tenant_id])
  landlord         landlord?               @relation(fields: [landlord_id], references: [landlord_id])
  property         property?               @relation(fields: [property_id], references: [property_id])

  @@index([landlord_id])
  @@index([property_id])
  @@index([tenant_id])
}

model review {
  review_id   Int       @id @default(autoincrement())
  tenant_id   Int?
  property_id Int?
  rating      Int?
  review_text String?
  created_at  DateTime  @default(now())
  tenant      tenant?   @relation(fields: [tenant_id], references: [tenant_id])
  property    property? @relation(fields: [property_id], references: [property_id])

  @@index([property_id])
  @@index([tenant_id])
}

model tenant {
  tenant_id           Int                  @id @default(autoincrement())
  name                String
  email               String               @unique
  phone_number        String
  date_of_birth       DateTime?
  gender              tenant_gender?
  profile_image_url   String?              
  created_at          DateTime             @default(now())
  bookinginquiry      bookinginquiry[]
  favoriteproperties  favoriteproperties[]
  maintenancerequest  maintenancerequest[]
  notification        notification[]
  rentalagreement     rentalagreement[]
  review              review[]
  transaction         transaction[]
}

model transaction {
  transaction_id     Int                             @id @default(autoincrement())
  user_id            Int?
  transaction_type   transaction_transaction_type
  amount             Decimal                         // MySQL handles DECIMAL natively
  transaction_date   DateTime                        @default(now())
  transaction_status transaction_transaction_status? @default(Pending)
  tenant             tenant?                         @relation(fields: [user_id], references: [tenant_id])

  @@index([user_id])
}

enum notification_notification_type {
  Alert
  Reminder
  Message
}

enum transaction_transaction_type {
  Payment
  Refund
  Fee
}

enum admin_role {
  Super_Admin @map("Super Admin")
  Moderator
  Support
}

enum bookinginquiry_status {
  Pending
  Reviewed
  Resolved
}

enum maintenancerequest_status {
  Pending
  In_Progress @map("In Progress")
  Resolved
}

enum payment_payment_method {
  Bank_Transfer @map("Bank Transfer")
  Credit_Card   @map("Credit Card")
  Mobile_Money  @map("Mobile Money")
  Cash
}

enum property_property_type {
  Apartment
  House
  Studio
  Villa
  Other
}

enum notification_read_status {
  Unread
  Read
}

enum payment_payment_status {
  Pending
  Completed
  Failed
}

enum tenant_gender {
  Male
  Female
}

enum transaction_transaction_status {
  Pending
  Completed
  Failed
}

enum rentalagreement_status {
  Active
  Completed
  Terminated
}

enum property_availability_status {
  Available
  Rented
}
